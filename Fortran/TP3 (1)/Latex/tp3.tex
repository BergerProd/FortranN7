\documentclass[12pt]{article}
\usepackage[french]{babel}
\usepackage{times}
\usepackage[T1]{fontenc}
\usepackage{setspace}
\usepackage{graphics}

\newcommand{\dsp}{\displaystyle}
 

\hoffset=-20mm
\voffset=-4cm
\topmargin=10mm
\headheight=10mm
\headsep=15mm
\textheight=240mm
\oddsidemargin=15mm
\evensidemargin=15mm
\textwidth=170mm
\pagestyle{plain}



 
 
%   DEFINITIONS

\newcommand{\ins}[1]{\texttt{#1}}

 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%                    DEBUT DU DOCUMENT
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{center}
 {\bf TP d'informatique\\
 Première année apprentissage, mécanique des fluides
 }
 
{ \Large  Lecture de paramètres par fichier d'entrée, allocation dynamique, discrétisation } 

\end{center} 

Travail à mener sur une seule séance.

%************************
\section{Objectif du TP}
%************************
\begin{itemize}
    \item Apprendre à utiliser un fichier de paramètres
    \item Comprendre des modules ou procédures déjà écrites
    \item Assembler dans un programme principale les différentes fonctions
        pour répondre aux fonctions du programme.
    \item Apprendre à déclarer des tableaux dynamiques
    \item Comprendre comment calculer numériquement une dérivée de fonction.
\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%

Pour éviter la tâche répétitive  d'entrer les paramètres ou options d'un programme 
au le clavier 
il est recommandé de toujours écrire un fichier de paramètres qu'on ouvre et modifie
en cas de besoin.

Lire ce fichier est très souvent 
la première tâche d'un programme.

Dans ce TP, on devoir uniquement écrire le programme principal en comprenant 
ce qu'il doit faire et en utilisant les sources fournies.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Objet du programme}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Le programme a pour objectif de calculer numériquement
les dérivées de fonctions  en utilisant un schéma
de discrétisation par différences finies d'ordre 2. Ce genre de schémas numériques sont 
obtenus par des développements limités en série de Taylor.

Le schéma est le suivant pour une maillage régulier, de taille $n$, de pas constant $h$ :

$$
\begin{array}{lcl}
	\dsp f_{num}'(x_i) &\approx&\dsp \frac{ f(x_{i+1})- f(x_{i-1})}{2 h}, \qquad \textrm{pour} \quad i=2..n-1 \vspace{0.3cm} \\
	\dsp f_{num}'(x_1) &\approx&\dsp \frac{ -3 f(x_1)+4 f(x_2)-f(x_3)}{2 h} \vspace{0.3cm}\\
	\dsp f_{num}'(x_n) &\approx&\dsp \frac{ 3 f(x_n)-4 f(x_{n-1})+f(x_{n-2})}{2 h} \\
\end{array}
$$

Les trois fonctions testées sont :
\begin{enumerate}
	\item $\dsp y_1(x)=\sin^2(x) \ \cos(x)$
	\item $\dsp y_2(x)=2 \ x + 0.5 \ x^2$
	\item $\dsp y_3(x)=2 \ \exp(-0.05 \ x) \cos(3 \ x)$
\end{enumerate}
pour $ 0\le x \le 4$.

On validera le code en comparant la solution analytique à la solution trouvée numériquement sur 
la base d'une erreur
 relative  définie ainsi :
$$
\dsp \varepsilon(x_i) = \left|  1 - \frac{y'_{num.}(x_i)} {y'_{analy.}(x_i)} \right |, \qquad \textrm{si}\qquad y'_{analy.}(x_i)\ne 0
$$
 et $\varepsilon_{\log}(x_i)=\log10(\varepsilon(x_i))$



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Déroulement du TP}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Tâches à implémenter dans le programme}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

La programmation a lieu dans le dossier \ins{Fortran}. Mais on lance le programme dans \ins{RUN}.


\begin{enumerate}
	\item Charger l'archive \ins{TP3.tar} sur moodle et l'ouvrir avec
        par exemple \ins{tar -xvf TP3.tar} dans un terminal.
		On travaillera dans le dossier \ins{tp3}
    \item L'archive comprend trois dossiers, celui contenant les sources fortran, celui où sera lancé le code, et un dossier  \ins{Latex} contenant l'énoncé du TP.
    \item Le programme doit effectuer différentes tâches  pour fonctionner et être validé :
        \begin{enumerate}
            \item Lire les paramètres
            \item Allouer les variables (allocation dynamique)
            \item Calculer la solution $y(x)$ et sa dérivée analytique 
            \item Calculer la dérivée  de la fonction numériquement.
            \item Calculer créer une fonction d'erreur
            \item On cherchera le maximun de l'erreur, ainsi que sa position
            \item Dans une fichier de sortie \ins{tp3.out}, 
                écrire les valeurs de la $x$, de la fonction, des dérivées analytiques 
                et numériques, de l'erreur et du LOG10 de l'erreur (attention aux valeurs!)
        \end{enumerate}

    \item Un travail préliminaire a été effectué. Un module et des procédures ou fonctions ont été créées. Ce sont les sources du code.

        Le fichier des paramètres \ins{tp3.in} se trouve lui dans le dossier \ins{RUN}. 
        Vérifier si le fichier présent contient les éléments suivants:
		\begin{enumerate}
			\item \ins{option} qui permet de choisir
une fonction (au choix, 3 fonctions : une contenant des cosinus  et sinus,
une avec un polyn\^ome  et une avec des exponentielles)
			\item \ins{$x_1$} et \ins{$x_2$}  qui définissent les intervalles d'études 
			\item \ins{npt} qui définit le nombre de points du maillage (constant)
		\end{enumerate}

	\item Ouvrir le module, analyser son contenu. Il contient des paramètres ou variables globales et des tableaux dynamiques. Vérifier la conformité avec les objectifs du problème.
    \item Ouvir le fichier contenant l'ensemble des fonctions ou procédures, et les analyser une par une pour comprendre les points suivants :
        \begin{itemize}
            \item Les entrées
            \item Les sorties
            \item Les variables locales
            \item Les tâches effectuées
        \end{itemize}
    \item Ouvrir le \ins{Makefile} et vérifier sa configuration.
    \item  Seul le fichier \ins{tp3.f90} sera complété, les autres fichiers ne doivent pas être modifiés. A partir des codes sources et de leur analyse, il faut
    écrire le code principal pour remplir les tâches décrites plus haut.

        Il faut procéder très progressivement en compilant souvent pour vérifier de l'éxactitude du code entré.
    \item Dans le dossier \ins{RUN} tester le code et vérifier que les objectifs sont atteints, 
        notamment en dessinant à l'écran les différentes courbes, fonctions, dérivées, erreurs relatives pour différentes fonctions et jeux de paramètres (gnuplot, xmgrace).

Faire une étude paramétrique en fonction de la fonction sélectionnée et 
        du nombre de points de discrétisation (101, 201, 1001, 5001)
    \item Tirer des conclusions qualitatives et quantitatives notamment sur les erreurs de discrétisation.
\end{enumerate}


\end{document}
